<html>
<body>
  <h2>Assignment 4: Sweet Tooth Paradise</h2> 
  <br>
  <h3>Cakes (XML)</h3>
  <div id="cakes">
  </div>
  <br>
  <h3>Candies (JSON)</h3>
  <div id="candies">
  </div>
  <br>
  <button type="button" onclick="GetXMLList()">
    Get List of Cakes
  </button>
  <br>
  <button type="button" onclick="GetJsonList()">
    Get List of Candies
  </button>

  <script>
    // XML
    function GetXMLList() {
        var xhttpRequest = new XMLHttpRequest();
        xhttpRequest.responseType = 'text/xml';
        xhttpRequest.onreadystatechange = function () {
            if (xhttpRequest.readyState == 4 && xhttpRequest.status == 200) {
                ProcessXMLDocument(xhttpRequest.responseXML);
            }
        };
        xhttpRequest.open("GET", "assignment4.xml",true);
        xhttpRequest.send();
    }
    function ProcessXMLDocument(xmlDoc) {
        for (let i = 0; i < xmlDoc.getElementsByTagName("cakes")[0].children.length; i++) {
            // Add $2.50 to the price of each cake.
            xmlDoc.getElementsByTagName("cakes")[0].xmlDoc.getElementsByTagName("cake")[i].getElementsByTagName("price")[0].nodeValue = (xmlDoc.getElementsByTagName("price")[0].nodeValue + 2.50)
            let para = document.createElement("p");
            let node = document.createTextNode(
                "Cake Type: " + xmlDoc.getElementsByTagName("cakes")[0].xmlDoc.getElementsByTagName("cake")[i].getElementsByTagName("type")[0].nodeValue + 
            ", \nCake Size: " + xmlDoc.getElementsByTagName("cakes")[0].xmlDoc.getElementsByTagName("cake")[i].getElementsByTagName("size")[0].nodeValue + 
            ", \nPrice of Cake: " + xmlDoc.getElementsByTagName("cakes")[0].xmlDoc.getElementsByTagName("cake")[i].getElementsByTagName("price")[0].nodeValue);
            para.appendChild(node);
            let element = document.getElementById("cakes");
            element.appendChild(para);
        }
    }

    // JSON
    function GetJsonList() {
      var xhttp = new XMLHttpRequest();
      xhttp.timeout = 3000;
      xhttp.responseType = "json";
      xhttp.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
          ProcessJSON(this.response);
        }
      };
      xhttp.open("GET", "assignment4.json", true);
      xhttp.send();
    }

    function ProcessJSON(json) {
      var br = document.createElement("br");
      for(let i = 0; i < json.candies.length; i++) {
        let para = document.createElement("p");
        // Add the price of $0.50 for each candy.
        let node = document.createTextNode("Candy Type: " + json.candies[i].type + ", \nCandy Price: " + (json.candies[i].price + 0.50) + ", \nQuantity of Candy: " + json.candies[i].quantity);
        para.appendChild(node);
        let element = document.getElementById("candies");
        element.appendChild(para);
      }
    }
  </script>
</body>
</html>